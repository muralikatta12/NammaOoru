<div class="container py-5">
  <!-- Header + Create Button -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="display-5 fw-bold text-success mb-0">NammaOoru Dashboard</h1>
    <a routerLink="/reports/new" class="btn btn-success btn-lg shadow">
      <i class="bi bi-plus-circle-fill me-2"></i> Create New Report
    </a>
  </div>

  <!-- Navigation Tabs -->
  <div class="mb-5">
    <div class="btn-group w-100 shadow-sm" role="group">
      <a routerLink="/dashboard" routerLinkActive="active" 
         class="btn btn-outline-success btn-lg rounded-start">Dashboard</a>
      <a routerLink="/reports" routerLinkActive="active" 
         class="btn btn-outline-success btn-lg rounded-end">All Reports</a>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="row g-4 mb-5">
    <div class="col-md-3">
      <div class="card stat-card text-white border-0 shadow-lg rounded-4">
        <div class="card-body text-center py-5">
          <i class="bi bi-file-earmark-text display-1 mb-3"></i>
          <h2 class="display-5 fw-bold">{{ stats.total }}</h2>
          <p class="fs-5 mb-0">Total Reports</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white border-0 shadow-lg rounded-4" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
        <div class="card-body text-center py-5">
          <i class="bi bi-hourglass-split display-1 mb-3"></i>
          <h2 class="display-5 fw-bold">{{ stats.submitted }}</h2>
          <p class="fs-5 mb-0">Submitted</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white border-0 shadow-lg rounded-4" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
        <div class="card-body text-center py-5">
          <i class="bi bi-tools display-1 mb-3"></i>
          <h2 class="display-5 fw-bold">{{ stats.inProgress }}</h2>
          <p class="fs-5 mb-0">In Progress</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white border-0 shadow-lg rounded-4" style="background: linear-gradient(135deg, #10b981, #059669);">
        <div class="card-body text-center py-5">
          <i class="bi bi-check2-circle display-1 mb-3"></i>
          <h2 class="display-5 fw-bold">{{ stats.resolved }}</h2>
          <p class="fs-5 mb-0">Resolved</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="row mb-5">
    <div class="col-lg-8 mx-auto">
      <div class="card shadow-lg border-0 rounded-4">
        <div class="card-body p-5">
          <h4 class="fw-bold mb-4">Overall Resolution Progress</h4>
          <div class="d-flex justify-content-between mb-2">
            <span class="fs-5">Resolved Reports</span>
            <strong class="fs-5">{{ stats.resolved }} / {{ stats.total }}</strong>
          </div>
          <div class="progress bg-light" style="height: 35px; border-radius: 20px;">
            <div class="progress-bar bg-success progress-bar-striped progress-bar-animated"
                 [style.width.%]="getProgress(2)"
                 style="border-radius: 20px;">
              <span class="fw-bold">{{ getProgress(2) | number:'1.0-0' }}%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Category + Recent Reports -->
  <div class="row">
    <div class="col-lg-6 mb-4">
      <div class="card shadow-lg border-0 rounded-4 h-100">
        <div class="card-body p-4">
          <h4 class="fw-bold mb-4">Reports by Category</h4>
          <div *ngFor="let cat of categoryStats" class="d-flex align-items-center mb-3">
            <div class="rounded-circle me-3" [style.background-color]="cat.color" style="width:40px;height:40px;"></div>
            <div class="flex-grow-1">
              <div class="d-flex justify-content-between">
                <span class="fw-semibold">{{ cat.name }}</span>
                <strong>{{ cat.count }}</strong>
              </div>
              <div class="progress mt-1" style="height: 8px;">
                <div class="progress-bar" [style.background-color]="cat.color"
                     [style.width.%]="(cat.count / stats.total) * 100"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card shadow-lg border-0 rounded-4 h-100">
        <div class="card-body p-4">
          <h4 class="fw-bold mb-4">Recent Reports</h4>
          <div *ngFor="let r of recentReports" class="d-flex mb-3 pb-3 border-bottom">
            <img [src]="'https://localhost:5077' + (r.photos[0]?.photoUrl || '/assets/placeholder.jpg')"
                 class="rounded me-3" width="60" height="60" style="object-fit: cover;">
            <div class="flex-grow-1">
              <h6 class="mb-1">{{ r.title }}</h6>
              <small class="text-muted">{{ r.locationAddress }}</small>
            </div>
            <span class="badge fs-6" [ngClass]="{
              'bg-warning text-dark': r.status === 0,
              'bg-info text-white': r.status === 1,
              'bg-success text-white': r.status === 2,
              'bg-secondary text-white': r.status === 3
            }">
              {{ ['Submitted','In Progress','Resolved','Closed'][r.status] }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>